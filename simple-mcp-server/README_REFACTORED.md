# HTTP MCP Server - é‡æ„ç‰ˆæœ¬

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ HTTP MCP Server çš„é‡æ„ç‰ˆæœ¬ï¼Œé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä»£ç ç»“æ„æ›´æ¸…æ™°ï¼Œæ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
simple-mcp-server/
â”œâ”€â”€ ğŸ“ æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ models.py                    # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ config.py                    # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ tools.py                     # å·¥å…·å¤„ç†å™¨
â”‚   â”œâ”€â”€ websocket_manager.py         # WebSocketè¿æ¥ç®¡ç†
â”‚   â”œâ”€â”€ langchain_handler_new.py     # LangChainå¤„ç†å™¨ï¼ˆé‡æ„ç‰ˆï¼‰
â”‚   â””â”€â”€ http_mcp_server_new.py       # ä¸»æœåŠ¡å™¨ï¼ˆé‡æ„ç‰ˆï¼‰
â”‚
â”œâ”€â”€ ğŸ“ é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config.json                  # æœåŠ¡å™¨é…ç½®
â”‚
â”œâ”€â”€ ğŸ“ åŸå§‹æ–‡ä»¶ï¼ˆå‘åå…¼å®¹ï¼‰
â”‚   â”œâ”€â”€ http_mcp_server.py           # åŸå§‹æœåŠ¡å™¨
â”‚   â”œâ”€â”€ langchain_handler.py         # åŸå§‹LangChainå¤„ç†å™¨
â”‚   â””â”€â”€ http_mcp_client.py           # HTTPå®¢æˆ·ç«¯
â”‚
â”œâ”€â”€ ğŸ“ å‰ç«¯ç•Œé¢
â”‚   â”œâ”€â”€ chat_interface.html          # èŠå¤©ç•Œé¢
â”‚   â””â”€â”€ chat_interface.js            # å‰ç«¯è„šæœ¬
â”‚
â””â”€â”€ ğŸ“ ä¾èµ–æ–‡ä»¶
    â”œâ”€â”€ http_requirements.txt        # HTTPæœåŠ¡ä¾èµ–
    â””â”€â”€ langchain_requirements.txt   # LangChainä¾èµ–
```

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. models.py - æ•°æ®æ¨¡å‹
- ğŸ“¦ **åŠŸèƒ½**: å®šä¹‰æ‰€æœ‰æ•°æ®æ¨¡å‹å’Œç±»å‹
- ğŸ¯ **èŒè´£**: 
  - MCPå·¥å…·ç›¸å…³æ¨¡å‹
  - èŠå¤©è¯·æ±‚/å“åº”æ¨¡å‹
  - WebSocketæ¶ˆæ¯æ¨¡å‹
  - é…ç½®æ¨¡å‹
  - é”™è¯¯å¤„ç†æ¨¡å‹

### 2. config.py - é…ç½®ç®¡ç†
- ğŸ“¦ **åŠŸèƒ½**: ç»Ÿä¸€çš„é…ç½®ç®¡ç†ç³»ç»Ÿ
- ğŸ¯ **èŒè´£**:
  - é…ç½®æ–‡ä»¶è¯»å–å’ŒéªŒè¯
  - ç¯å¢ƒå˜é‡å¤„ç†
  - é»˜è®¤é…ç½®æä¾›
  - é…ç½®çƒ­é‡è½½

### 3. tools.py - å·¥å…·å¤„ç†å™¨
- ğŸ“¦ **åŠŸèƒ½**: MCPå·¥å…·çš„å®ç°å’Œç®¡ç†
- ğŸ¯ **èŒè´£**:
  - å·¥å…·æ‰§è¡Œå™¨åŸºç±»
  - æ–‡ä»¶æ“ä½œå·¥å…·å®ç°
  - å·¥å…·æ³¨å†Œå’Œç®¡ç†
  - å®‰å…¨æ€§æ£€æŸ¥

### 4. websocket_manager.py - WebSocketç®¡ç†
- ğŸ“¦ **åŠŸèƒ½**: WebSocketè¿æ¥çš„ç»Ÿä¸€ç®¡ç†
- ğŸ¯ **èŒè´£**:
  - è¿æ¥ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - æ¶ˆæ¯å¹¿æ’­å’Œå•æ’­
  - å¿ƒè·³æ£€æµ‹
  - è¿æ¥ç»Ÿè®¡

### 5. langchain_handler_new.py - LangChainå¤„ç†å™¨
- ğŸ“¦ **åŠŸèƒ½**: LangChainé›†æˆå’ŒAIæ¨¡å‹è°ƒç”¨
- ğŸ¯ **èŒè´£**:
  - æ¨¡å‹å®¢æˆ·ç«¯ç®¡ç†
  - å·¥å…·ç»‘å®š
  - èŠå¤©å¤„ç†é€»è¾‘
  - é”™è¯¯å¤„ç†

### 6. http_mcp_server_new.py - ä¸»æœåŠ¡å™¨
- ğŸ“¦ **åŠŸèƒ½**: FastAPIæœåŠ¡å™¨ä¸»ç¨‹åº
- ğŸ¯ **èŒè´£**:
  - è·¯ç”±å®šä¹‰
  - ä¸­é—´ä»¶é…ç½®
  - ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - é”™è¯¯å¤„ç†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
# åŸºç¡€HTTPæœåŠ¡ä¾èµ–
pip install -r http_requirements.txt

# LangChainä¾èµ–ï¼ˆèŠå¤©åŠŸèƒ½ï¼‰
pip install -r langchain_requirements.txt
```

### 2. é…ç½®è®¾ç½®
ç¼–è¾‘ `config.json` æ–‡ä»¶ï¼Œæˆ–è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
# OpenAI APIå¯†é’¥
export OPENAI_API_KEY="your_openai_key"

# DeepSeek APIå¯†é’¥  
export DEEPSEEK_API_KEY="your_deepseek_key"
```

### 3. å¯åŠ¨æœåŠ¡å™¨
```bash
# ä½¿ç”¨é‡æ„ç‰ˆæœ¬
python http_mcp_server_new.py

# æˆ–ä½¿ç”¨åŸç‰ˆæœ¬ï¼ˆå‘åå…¼å®¹ï¼‰
python http_mcp_server.py
```

### 4. è®¿é—®æœåŠ¡
- ğŸŒ **æœåŠ¡å™¨**: http://localhost:8000
- ğŸ“š **APIæ–‡æ¡£**: http://localhost:8000/docs
- ğŸ’¬ **èŠå¤©ç•Œé¢**: http://localhost:8000/static/chat_interface.html
- ğŸ”Œ **WebSocket**: ws://localhost:8000/ws

## ğŸ“– APIæ–‡æ¡£

### åŸºç¡€API
- `GET /` - æœåŠ¡å™¨ä¿¡æ¯
- `GET /health` - å¥åº·æ£€æŸ¥

### å·¥å…·API
- `GET /tools` - åˆ—å‡ºå¯ç”¨å·¥å…·
- `POST /tools/call` - è°ƒç”¨å·¥å…·
- `GET /tools/stats` - å·¥å…·ç»Ÿè®¡

### èŠå¤©API
- `POST /chat` - HTTPèŠå¤©æ¥å£
- `WebSocket /ws` - WebSocketèŠå¤©

### ç®¡ç†API
- `GET /admin/connections` - WebSocketè¿æ¥ä¿¡æ¯
- `GET /admin/config` - å½“å‰é…ç½®
- `POST /admin/config/reload` - é‡è½½é…ç½®

## âš™ï¸ é…ç½®è¯´æ˜

### æœåŠ¡å™¨é…ç½®
```json
{
  "server": {
    "host": "0.0.0.0",
    "port": 8000,
    "debug": false,
    "log_level": "INFO",
    "cors_origins": ["*"]
  }
}
```

### æ¨¡å‹é…ç½®
```json
{
  "models": {
    "openai": {
      "model_name": "gpt-3.5-turbo",
      "temperature": 0.7,
      "max_tokens": 1000
    },
    "deepseek": {
      "model_name": "deepseek-chat",
      "temperature": 0.7,
      "max_tokens": 1000,
      "base_url": "https://api.deepseek.com"
    }
  }
}
```

### å·¥å…·é…ç½®
```json
{
  "tools": {
    "enabled": ["read_file", "write_file", "list_files"],
    "file_operations": {
      "max_file_size": 10485760,
      "allowed_extensions": [".txt", ".json", ".md"],
      "base_directory": ".",
      "create_directories": true
    }
  }
}
```

## ğŸ”„ ä»åŸç‰ˆæœ¬è¿ç§»

### 1. ä½¿ç”¨é‡æ„ç‰ˆæœ¬
```python
# å¯åŠ¨é‡æ„ç‰ˆæœåŠ¡å™¨
python http_mcp_server_new.py
```

### 2. é…ç½®è¿ç§»
é‡æ„ç‰ˆæœ¬ä½¿ç”¨ `config.json` ç»Ÿä¸€é…ç½®ï¼ŒåŸç‰ˆæœ¬çš„ç¡¬ç¼–ç é…ç½®éœ€è¦è¿ç§»åˆ°é…ç½®æ–‡ä»¶ã€‚

### 3. APIå…¼å®¹æ€§
é‡æ„ç‰ˆæœ¬ä¿æŒä¸åŸç‰ˆæœ¬çš„APIå…¼å®¹æ€§ï¼Œç°æœ‰å®¢æˆ·ç«¯ä»£ç æ— éœ€ä¿®æ”¹ã€‚

## ğŸ¯ é‡æ„ä¼˜åŠ¿

### 1. **æ¨¡å—åŒ–è®¾è®¡**
- å•ä¸€èŒè´£åŸåˆ™
- ä½è€¦åˆé«˜å†…èš
- æ˜“äºæµ‹è¯•å’Œç»´æŠ¤

### 2. **é…ç½®ç»Ÿä¸€ç®¡ç†**
- é›†ä¸­é…ç½®æ–‡ä»¶
- ç¯å¢ƒå˜é‡æ”¯æŒ
- é…ç½®éªŒè¯å’Œçƒ­é‡è½½

### 3. **æ›´å¥½çš„é”™è¯¯å¤„ç†**
- ç»Ÿä¸€é”™è¯¯æ¨¡å‹
- è¯¦ç»†é”™è¯¯ä¿¡æ¯
- ä¼˜é›…çš„é”™è¯¯æ¢å¤

### 4. **å¢å¼ºçš„ç›‘æ§**
- è¿æ¥çŠ¶æ€ç›‘æ§
- å·¥å…·ä½¿ç”¨ç»Ÿè®¡
- æ€§èƒ½æŒ‡æ ‡æ”¶é›†

### 5. **ä»£ç å¯ç»´æŠ¤æ€§**
- æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ
- å®Œå–„çš„ç±»å‹æ³¨è§£
- è¯¦ç»†çš„æ–‡æ¡£æ³¨é‡Š

## ğŸ§ª å¼€å‘å’Œæµ‹è¯•

### 1. å¼€å‘æ¨¡å¼
```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
python http_mcp_server_new.py --debug
```

### 2. æµ‹è¯•å·¥å…·
```python
# æµ‹è¯•å·¥å…·è°ƒç”¨
from tools import execute_tool
result = await execute_tool("read_file", {"file_path": "test.txt"})

# æµ‹è¯•é…ç½®
from config import get_config
server_config = get_config("server")
```

### 3. æ—¥å¿—è°ƒè¯•
æ—¥å¿—æ–‡ä»¶: `mcp_server.log`
```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f mcp_server.log
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. **ä»£ç é£æ ¼**: éµå¾ªPEP 8
2. **ç±»å‹æ³¨è§£**: ä½¿ç”¨å®Œæ•´çš„ç±»å‹æ³¨è§£
3. **æ–‡æ¡£**: æ·»åŠ è¯¦ç»†çš„docstring
4. **æµ‹è¯•**: ç¼–å†™å•å…ƒæµ‹è¯•
5. **æ—¥å¿—**: é€‚å½“çš„æ—¥å¿—è®°å½•

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0.0 (é‡æ„ç‰ˆæœ¬)
- âœ… æ¨¡å—åŒ–é‡æ„
- âœ… ç»Ÿä¸€é…ç½®ç®¡ç†
- âœ… å¢å¼ºé”™è¯¯å¤„ç†
- âœ… WebSocketè¿æ¥ç®¡ç†
- âœ… å·¥å…·ç»Ÿè®¡å’Œç›‘æ§
- âœ… å‘åå…¼å®¹æ€§

### v1.0.0 (åŸå§‹ç‰ˆæœ¬)
- âœ… åŸºç¡€HTTP MCPæœåŠ¡å™¨
- âœ… LangChainé›†æˆ
- âœ… WebSocketæ”¯æŒ
- âœ… æ–‡ä»¶æ“ä½œå·¥å…·

---

ğŸ‰ **é‡æ„ç‰ˆæœ¬æä¾›äº†æ›´å¥½çš„ä»£ç ç»“æ„å’Œæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¿æŒäº†ä¸åŸç‰ˆæœ¬çš„å®Œå…¨å…¼å®¹ï¼**
